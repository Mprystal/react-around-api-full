(this["webpackJsonpreact-around-auth"]=this["webpackJsonpreact-around-auth"]||[]).push([[0],{29:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),o=n.n(c),r=n(17),s=n.n(r),i=n(11),l=(n(29),n(21)),u=n(3),d=n(2),p=n.p+"static/media/Vectorlogo.c7581985.svg";var h=function(e){var t=e.loggedIn,n=e.handleSignOut,c=e.path,o=e.email;return Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)("img",{src:p,alt:"Logo",className:"header__logo"}),Object(a.jsxs)("div",{className:"header__login-container",children:[t?Object(a.jsxs)("p",{className:"header__paragraph",children:[" ",o," "]}):"",t?Object(a.jsx)("button",{onClick:n,className:"header__button",children:"Log out"}):t||"signin"!==c?Object(a.jsx)("a",{href:"/signin",className:"header__link",children:"Log in"}):Object(a.jsx)("a",{href:"/signup",className:"header__link",children:"Sign up"})]})]})},j=o.a.createContext();var m=function(e){var t=o.a.useContext(j),n=e.ownerId===t._id,c="element__card-remove ".concat(n?"element__card-remove":"element__card-hidden"),r=e.card.likes.some((function(e){return e._id===t._id})),s="".concat(r?"element__card-heart_active":"element__card-heart");return Object(a.jsxs)("li",{className:"element__card",children:[Object(a.jsx)("button",{onClick:function(t){e.onCardDelete(t)},className:c,"aria-label":"Remove card button",type:"button"}),Object(a.jsx)("div",{onClick:function(){e.onCardClick()},className:"element__card-img",style:{backgroundImage:"url(".concat(e.src,")")}}),Object(a.jsx)("h2",{className:"element__card-heading",children:e.title}),Object(a.jsxs)("div",{className:"element__card-group-likes",children:[Object(a.jsx)("button",{className:s,onClick:function(t){e.onCardLike(t)},"aria-label":"Like this card button",type:"button"}),Object(a.jsx)("p",{className:"element__card-likes",children:e.likes})]})]})};var b=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__text",children:"\xa9 2020 Around The U.S."})})};var f=function(e){var t=o.a.useContext(j);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(h,{loggedIn:e.loggedIn,handleSignOut:e.handleSignOut,email:e.email}),Object(a.jsxs)("main",{children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__container",children:[Object(a.jsx)("button",{className:"profile__img-form",onClick:e.onEditAvatar,"aria-label":"Change profile picture button",type:"button",children:Object(a.jsx)("div",{className:"profile__img",style:{backgroundImage:"url(".concat(t.avatar,")")}})}),Object(a.jsxs)("div",{className:"profile__info",children:[Object(a.jsxs)("div",{className:"profile__edit",children:[Object(a.jsx)("h1",{className:"profile__name",children:t.name}),Object(a.jsx)("button",{className:"profile__edit-button",onClick:e.onEditProfile,"aria-label":"Edit profile button",type:"button"})]}),Object(a.jsx)("p",{className:"profile__occupation",children:t.about})]})]}),Object(a.jsx)("button",{className:"profile__add-button",onClick:e.onAddPlace,"aria-label":"Add profile button",type:"button"})]}),Object(a.jsx)("section",{className:"elements",children:Object(a.jsx)("ul",{className:"element",children:e.cards.map((function(t){return Object(a.jsx)(m,{onCardClick:function(){e.onImage(t)},src:t.link,card:t,title:t.name,onCardLike:function(){e.onCardLike(t)},onCardDelete:function(){e.onCardDelete(t)},ownerId:t.owner._id,likes:t.likes.length},t._id)}))})})]}),Object(a.jsx)(b,{})]})};var _=function(e){return Object(a.jsx)("div",{className:"popup ".concat(e.name," ").concat(e.isOpen&&"popup_open"),children:Object(a.jsxs)("div",{className:"popup__container",children:[Object(a.jsx)("button",{onClick:e.onClose,className:"popup__close-button","aria-label":"Close popup button",type:"button"}),Object(a.jsxs)("form",{action:"#",className:"popup__form",onSubmit:e.onSubmit,children:[Object(a.jsx)("h3",{className:"popup__header",children:e.title}),e.children,Object(a.jsx)("button",{type:"submit",className:"popup__save popup__save_disabled popup_save-edit",children:"Save"})]})]})})};var g=function(e){return void 0===e.card?null:Object(a.jsx)("div",{className:"popup popup_theme_trans popup_type_image ".concat(e.card&&"popup_open"),children:Object(a.jsxs)("div",{className:"popup__container",children:[Object(a.jsxs)("figure",{className:"popup__fig",children:[Object(a.jsx)("img",{className:"popup__figimg",src:"".concat(e.card.link),alt:"".concat(e.card.name)}),Object(a.jsx)("figcaption",{className:"popup__figcap",children:e.card.name})]}),Object(a.jsx)("button",{className:"popup__close-button","aria-label":"Close popup button",onClick:e.onClose,type:"button"})]})})};var O=function(e){var t=o.a.useState(""),n=Object(u.a)(t,2),c=n[0],r=n[1],s=o.a.useState(""),i=Object(u.a)(s,2),l=i[0],d=i[1],p=o.a.useContext(j);return o.a.useEffect((function(){r(p.name||""),d(p.about||"")}),[p]),Object(a.jsx)(_,{name:"popup_type_edit-profile",onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:l})},title:"Edit profile",children:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("input",{id:"profile-name",className:"popup__user-input popup__user-input_type_name",type:"text",name:"user_name",value:c,onChange:function(e){r(e.target.value)},required:!0,minLength:"2",maxLength:"40",placeholder:"User Name"}),Object(a.jsx)("span",{id:"profile-name-error",className:"popup__error"}),Object(a.jsx)("input",{id:"profile-about",className:"popup__user-input popup__user-input_type_about",type:"text",value:l,onChange:function(e){d(e.target.value)},name:"user_about",required:!0,minLength:"2",maxLength:"200",placeholder:"User About"}),Object(a.jsx)("span",{id:"profile-about-error",className:"popup__error"})]}),isOpen:e.isOpen,onClose:e.onClose})};var x=function(e){var t=o.a.useRef("");return Object(a.jsx)(_,{onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},name:"popup_type_profile-img",title:"Change Profile Picture",children:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("input",{id:"profile-img-url",className:"popup__user-input popup__user-input_url",type:"url",name:"link",ref:t,placeholder:"Image link",required:!0}),Object(a.jsx)("span",{id:"profile-img-url-error",className:"popup__error"})]}),isOpen:e.isOpen,onClose:e.onClose})};var v=function(e){var t=o.a.useState(""),n=Object(u.a)(t,2),c=n[0],r=n[1],s=o.a.useState(""),i=Object(u.a)(s,2),l=i[0],d=i[1];return Object(a.jsxs)(_,{name:"popup_type_add-card",onSubmit:function(t){t.preventDefault(),e.onAddPlaceSubmit({name:c,link:l}),r(""),d("")},title:"New Place",isOpen:e.isOpen,onClose:e.onClose,children:[Object(a.jsx)("input",{id:"card-title",className:"popup__user-input popup__user-input_card-heading",type:"text",name:"name",value:c,onChange:function(e){r(e.target.value)},placeholder:"Title",required:!0,minLength:"1",maxLength:"30"}),Object(a.jsx)("span",{id:"card-title-error",className:"popup__error"}),Object(a.jsx)("input",{id:"card-url",className:"popup__user-input popup__user-input_url",value:l,onChange:function(e){d(e.target.value)},type:"url",name:"link",placeholder:"Image link",required:!0}),Object(a.jsx)("span",{id:"card-url-error",className:"popup__error"})]})},N=n(18),C=n(19),k=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(N.a)(this,e),this._baseUrl=n,this._headers=a}return Object(C.a)(e,[{key:"getCardList",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error! ".concat(e.statusText)).catch((function(e){return console.log(e)}))}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error! ".concat(e.statusText)).catch((function(e){return console.log(e)}))}))}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error! ".concat(e.statusText)).catch((function(e){return console.log(e)}))}))}},{key:"removeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error! ".concat(e.statusText)).catch((function(e){return console.log(e)}))}))}},{key:"changeLikeCardStatus",value:function(e,t){var n=t?"DELETE":"PUT";return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:n,headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("Error! ".concat(e.statusText)).catch((function(e){return console.log(e)}))}))}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Error! ".concat(e.statusText)).catch((function(e){return console.log(e)}))}))}},{key:"setUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Error! ".concat(e.statusText)).catch((function(e){return console.log(e)}))}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-4",headers:{authorization:"df5252cc-ce9a-49bc-822a-e9a6c67f648c","Content-Type":"application/json"}});var S=function(e){var t=e.email,n=e.password,c=e.handlePasswordChange,o=e.handleEmailChange,r=e.handleRegisterSubmit;return Object(a.jsxs)("div",{className:"register",children:[Object(a.jsx)("h2",{className:"register__heading",children:"Sign up"}),Object(a.jsxs)("form",{onSubmit:r,className:"register__form",children:[Object(a.jsx)("input",{id:"email",name:"email",type:"email",className:"register__input",placeholder:"Email",value:t,onChange:o}),Object(a.jsx)("input",{id:"password",name:"password",type:"password",value:n,className:"register__input",placeholder:"Password",onChange:c}),Object(a.jsx)("button",{type:"submit",className:"register__button",children:"Sign up"})]}),Object(a.jsxs)("p",{className:"register__paragraph",children:[Object(a.jsx)("a",{href:"/signin",style:{textDecoration:"none",color:"white"},children:"Already a member? Log in here!"})," "]})]})};var y=function(e){var t=e.handleLoginSubmit,n=e.email,c=e.password,o=e.handlePasswordChange,r=e.handleEmailChange;return Object(a.jsxs)("div",{className:"login",children:[Object(a.jsx)("h2",{className:"login__heading",children:"Log in"}),Object(a.jsxs)("form",{onSubmit:t,className:"login__form",children:[Object(a.jsx)("input",{id:"email",name:"email",type:"email",className:"login__input",placeholder:"Email",value:n,onChange:r}),Object(a.jsx)("input",{id:"password",name:"password",type:"password",value:c,className:"login__input",placeholder:"Password",onChange:o}),Object(a.jsx)("button",{type:"submit",className:"login__button",children:"Log in"})]}),Object(a.jsxs)("p",{className:"login__paragraph",children:[Object(a.jsx)("a",{href:"/signup",style:{textDecoration:"none",color:"white"},children:"Not a member? Sign up here!"})," "]})]})},w="https://register.nomoreparties.co",E=n(22),P=n(23),T=function(e){var t=e.component,n=Object(P.a)(e,["component"]);return Object(a.jsx)(d.b,{children:function(){return n.loggedIn?Object(a.jsx)(t,Object(E.a)({},n)):Object(a.jsx)(d.a,{to:"./signup"})}})};var U=function(e){var t=e.onClose,n=e.image,c=e.open,o=e.message;return Object(a.jsx)("div",{className:"popup ".concat(c&&"popup_open"),children:Object(a.jsxs)("div",{className:"popup__container",children:[Object(a.jsx)("button",{className:"popup__close-button","aria-label":"Close popup button",onClick:t,type:"button"}),Object(a.jsxs)("div",{className:"infoTool",children:[Object(a.jsx)("img",{className:"infoTool__img",src:n,alt:"Success / failure icon"}),Object(a.jsx)("p",{className:"infoTool__paragraph",style:{color:"black"},children:o})]})]})})},L=n.p+"static/media/Unionchk.1b6082f8.svg",I=n.p+"static/media/Unionx.df8eddf6.svg";var A=function(){var e=Object(c.useState)(!1),t=Object(u.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(!1),i=Object(u.a)(s,2),p=i[0],m=i[1],b=Object(c.useState)(!1),N=Object(u.a)(b,2),C=N[0],E=N[1],P=Object(c.useState)(!1),A=Object(u.a)(P,2),D=A[0],F=A[1],J=Object(c.useState)(void 0),q=Object(u.a)(J,2),R=q[0],B=q[1],z=Object(c.useState)({}),H=Object(u.a)(z,2),G=H[0],M=H[1],V=Object(c.useState)([]),Y=Object(u.a)(V,2),K=Y[0],Q=Y[1],W=Object(c.useState)(!1),X=Object(u.a)(W,2),Z=X[0],$=X[1],ee=Object(c.useState)(""),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ce=Object(c.useState)(""),oe=Object(u.a)(ce,2),re=oe[0],se=oe[1],ie=Object(c.useState)(""),le=Object(u.a)(ie,2),ue=le[0],de=le[1],pe=Object(c.useState)(I),he=Object(u.a)(pe,2),je=he[0],me=he[1],be=Object(d.g)();o.a.useEffect((function(){var e,t=localStorage.getItem("jwt");t&&(e=t,fetch("".concat(w,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))).then((function(e){e&&(ae(e.data.email),$(!0),be.push("/"))}))}),[be]),o.a.useEffect((function(){Promise.all([k.getUserInfo(),k.getCardList()]).then((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];M(n),Q(a)})).catch((function(e){console.log("Error: ".concat(e))}))}),[]);var fe=function(){localStorage.removeItem("jwt"),$(!1),be.push("/signin")};function _e(){E(!1),r(!1),m(!1),B(void 0),F(!1)}function ge(e){ae(e.target.value)}function Oe(e){se(e.target.value)}return Object(a.jsx)(j.Provider,{value:G,children:Object(a.jsxs)("div",{className:"page",children:[Object(a.jsxs)(d.d,{children:[Object(a.jsx)(T,{exact:!0,path:"/",loggedIn:Z,handleSignOut:fe,component:f,onEditAvatar:function(){E(!0)},onEditProfile:function(){r(!0)},onAddPlace:function(){m(!0)},onImage:function(e){!function(e){B(e)}(e)},onCardLike:function(e){!function(e){var t=e.likes.some((function(e){return e._id===G._id}));k.changeLikeCardStatus(e._id,t).then((function(t){var n=K.map((function(n){return n._id===e._id?t:n}));Q(n)})).catch((function(e){return console.log(e)}))}(e)},onCardDelete:function(e){!function(e){k.removeCard(e._id).then((function(){var t=K.filter((function(t){return t._id!==e._id}));Q(t)})).catch((function(e){return console.log(e)}))}(e)},cards:K,email:ne}),Object(a.jsxs)(d.b,{exact:!0,path:"/signup",children:[Object(a.jsx)(h,{loggedIn:Z,handleSignOut:fe}),Object(a.jsx)(S,{email:ne,password:re,handleEmailChange:ge,handlePasswordChange:Oe,handleRegisterSubmit:function(e){e.preventDefault(),setTimeout((function(){F(!0)}),500),function(e,t){return fetch("".concat(w,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).catch((function(e){return console.log(e)}))}(ne,re).then((function(e){if(e&&400!==e.status)return e.status,e.json();throw new Error("Error!")})).then((function(){me(L),de("Success! You have now been registered.")})).then((function(){ae(""),se(""),setTimeout((function(){F(!1),me(""),be.push("/signin")}),1500)})).catch((function(){me(I),de("Oops, something went wrong! Please try again.")}))}})]}),Object(a.jsxs)(d.b,{exact:!0,path:"/signin",children:[Object(a.jsx)(h,{loggedIn:Z,path:"signin",handleSignOut:fe}),Object(a.jsx)(y,{handleLoginSubmit:function(e){e.preventDefault(),ne&&re&&function(e,t){return fetch("".concat(w,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){return e.token?(localStorage.setItem("jwt",e.token),e):void 0})).catch((function(e){return console.log(e)}))}(ne,re).then((function(e){if(!e)throw new Error("error!");if(e.token)return se(""),$(!0),void be.push("/")})).catch((function(e){return console.log(e)}))},email:ne,password:re,handleEmailChange:ge,handlePasswordChange:Oe})]}),Object(a.jsx)(d.b,{path:"*",children:Object(a.jsx)(d.a,{to:"./signup"})})]}),Object(a.jsx)(x,{onUpdateAvatar:function(e){var t=e.avatar;k.setUserAvatar(t).then((function(e){return M(e)})).then((function(){_e()})).catch((function(e){return console.log(e)}))},isOpen:C,onClose:_e}),Object(a.jsx)(O,{onUpdateUser:function(e){var t=e.name,n=e.about;k.setUserInfo({name:t,about:n}).then((function(e){return M(e)})).then((function(){_e()})).catch((function(e){return console.log(e)}))},isOpen:n,onClose:_e}),Object(a.jsx)(v,{onAddPlaceSubmit:function(e){var t=e.name,n=e.link;k.addCard({name:t,link:n}).then((function(e){return Q([e].concat(Object(l.a)(K)))})).then((function(){_e()})).catch((function(e){return console.log(e)}))},isOpen:p,onClose:_e}),Object(a.jsx)(_,{name:"popup_type_delete-card",title:"Are you sure?"}),Object(a.jsx)(g,{card:R,onClose:_e}),Object(a.jsx)(U,{image:je,message:ue,open:D,onClose:_e})]})})},D=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,39)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),o(e),r(e)}))};s.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(i.a,{children:Object(a.jsx)(A,{})})}),document.getElementById("root")),D()}},[[38,1,2]]]);
//# sourceMappingURL=main.0a942978.chunk.js.map